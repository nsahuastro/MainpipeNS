2025-11-25 23:17:03 [INFO] =*= Starting MainpipeNS pipeline =*=
2025-11-25 23:17:03 [INFO] Inspecting raw file...
2025-11-25 23:17:04 [INFO] Raw quick_stats:
2025-11-25 23:17:04 [INFO] {
  "file": "data/raw/mainpipe_data_v1.jsonl",
  "file_size_mb": 439.228,
  "total_lines": 269378,
  "sampled": 25000,
  "avg_length": 1589.76288,
  "median_length": 752.0,
  "p10": 187.0,
  "p90": 3211.0,
  "max_length": 178482,
  "min_length": 2,
  "empty_pct": 0.0,
  "short_pct": 3.832,
  "top_keys": [
    [
      "text",
      25000
    ],
    [
      "url",
      25000
    ]
  ]
}
2025-11-25 23:17:04 [INFO] category percentages in raw input file:
2025-11-25 23:17:28 [INFO] {
  "HTML": 23.14,
  "SHORT_ENGLISH": 7.76,
  "CODE_HEAVY": 20.971999999999998,
  "GOOD_ENGLISH": 40.568,
  "NON_ENGLISH_LANG": 7.5600000000000005
}
2025-11-25 23:17:28 [INFO] Saved raw category percentages to reports/raw_category_pct.json
2025-11-25 23:17:28 [INFO] Saved raw category percentage plot to figures/raw_category_pct.pdf
2025-11-25 23:17:28 [INFO] Deduplication...
2025-11-25 23:17:30 [INFO] Deduplicated data saved to data/dedup/dedup.jsonl
2025-11-25 23:17:30 [INFO] Cleaning dataset...
2025-11-25 23:22:42 [INFO] Cleaned data saved to data/clean/clean.jsonl
2025-11-25 23:22:42 [INFO] Cleaning summary: {'KEPT': 107320, 'NON_ENGLISH': 21200, 'CODE_HEAVY': 72472, 'HTML_STRIPPED': 53294, 'TOO_SHORT': 19622, 'TOO_LONG': 282}
2025-11-25 23:22:42 [INFO] Saved cleaning report figure to figures/clean_data_hist.pdf
2025-11-25 23:22:42 [INFO] Inspecting cleaned dataset...
2025-11-25 23:23:17 [INFO] Clean dataset category percentages:
2025-11-25 23:23:17 [INFO] {
  "GOOD_ENGLISH": 99.36,
  "SHORT_ENGLISH": 0.40800000000000003,
  "HTML": 0.232
}
2025-11-25 23:23:17 [INFO] Saved clean category percentages to reports/clean_category_pct.json
2025-11-25 23:23:17 [INFO] Saved clean category percentage plot to figures/clean_category_pct.pdf
2025-11-25 23:23:17 [INFO] Running quality report on cleaned dataset...
2025-11-25 23:26:42 [INFO] {
  "samples_analyzed": 1500,
  "pii_hits": {
    "email": 27,
    "phone": 57,
    "credit_card": 11
  },
  "toxicity": {
    "avg": 0.008553076535463333,
    "max": 0.8266723155975342
  },
  "perplexity": {
    "avg": 44.81059562158585,
    "median": 34.213706970214844
  },
  "language_distribution": {
    "EN": 1500
  },
  "analysis_time_sec": 204.78
}
2025-11-25 23:26:42 [INFO] Quality report:
2025-11-25 23:26:42 [INFO] {
  "samples_analyzed": 1500,
  "pii_hits": {
    "email": 27,
    "phone": 57,
    "credit_card": 11
  },
  "toxicity": {
    "avg": 0.008553076535463333,
    "max": 0.8266723155975342
  },
  "perplexity": {
    "avg": 44.81059562158585,
    "median": 34.213706970214844
  },
  "language_distribution": {
    "EN": 1500
  },
  "analysis_time_sec": 204.78
}
2025-11-25 23:26:42 [INFO] Computing token length statsâ€¦
2025-11-25 23:26:52 [INFO] Saved token-length statistics to reports/token_length_stats.json
2025-11-25 23:26:52 [INFO] Tokenization...
2025-11-25 23:27:05 [INFO] Tokenized data saved to data/final/tokenized.jsonl
2025-11-25 23:27:05 [INFO] Packing to 2048-token blocks...
2025-11-25 23:27:08 [INFO] Packed blocks saved to data/final/packed_blocks.jsonl
2025-11-25 23:27:08 [INFO] Diagnosing packed block lengths...
2025-11-25 23:27:11 [INFO] Train/Val/Test sharding...
2025-11-25 23:27:11 [INFO] Sharded dataset saved to data/final/sharded_dataset
2025-11-25 23:27:11 [INFO] Writing meta.json...
2025-11-25 23:27:11 [INFO] =*= Pipeline completed successfully =*=
2025-11-25 23:27:11 [INFO] Total pipeline time: 0:10:08
