2025-11-26 13:18:21 [INFO] =*= Starting MainpipeNS pipeline =*=
2025-11-26 13:18:21 [INFO] Inspecting raw file...
2025-11-26 13:18:21 [INFO] Raw quick_stats:
2025-11-26 13:18:21 [INFO] {
  "file": "data/raw/mainpipe_data_v1.jsonl",
  "file_size_mb": 439.228,
  "total_lines": 269378,
  "sampled": 25000,
  "avg_length": 1589.76288,
  "median_length": 752.0,
  "p10": 187.0,
  "p90": 3211.0,
  "max_length": 178482,
  "min_length": 2,
  "empty_pct": 0.0,
  "short_pct": 3.832,
  "top_keys": [
    [
      "text",
      25000
    ],
    [
      "url",
      25000
    ]
  ]
}
2025-11-26 13:18:21 [INFO] category percentages in raw input file:
2025-11-26 13:18:47 [INFO] {
  "NON_ENGLISH_LANG": 7.4719999999999995,
  "GOOD_ENGLISH": 40.332,
  "HTML": 24.016000000000002,
  "CODE_HEAVY": 20.952,
  "SHORT_ENGLISH": 7.228
}
2025-11-26 13:18:47 [INFO] Saved raw category percentages to reports/raw_category_pct.json
2025-11-26 13:18:47 [INFO] Saved raw category percentage plot to figures/raw_category_pct.pdf
2025-11-26 13:18:47 [INFO] Deduplication...
2025-11-26 13:18:50 [INFO] Deduplicated data saved to data/dedup/dedup.jsonl
2025-11-26 13:18:50 [INFO] Cleaning dataset...
2025-11-26 13:24:13 [INFO] Cleaned data saved to data/clean/clean.jsonl
2025-11-26 13:24:13 [INFO] Cleaning summary: {'KEPT': 107320, 'NON_ENGLISH': 21200, 'CODE_HEAVY': 72472, 'HTML_STRIPPED': 53294, 'TOO_SHORT': 19622, 'TOO_LONG': 282}
2025-11-26 13:24:13 [INFO] Saved cleaning report figure to figures/clean_data_hist.pdf
2025-11-26 13:24:13 [INFO] Inspecting cleaned dataset...
2025-11-26 13:24:48 [INFO] Clean dataset category percentages:
2025-11-26 13:24:48 [INFO] {
  "GOOD_ENGLISH": 99.276,
  "HTML": 0.20400000000000001,
  "SHORT_ENGLISH": 0.52
}
2025-11-26 13:24:48 [INFO] Saved clean category percentages to reports/clean_category_pct.json
2025-11-26 13:24:48 [INFO] Saved clean category percentage plot to figures/clean_category_pct.pdf
2025-11-26 13:24:48 [INFO] Running quality report on cleaned dataset...
2025-11-26 13:28:24 [INFO] {
  "samples_analyzed": 1500,
  "pii_hits": {
    "phone": 69,
    "email": 24,
    "credit_card": 9
  },
  "toxicity": {
    "avg": 0.00878127571195364,
    "max": 0.9331499934196472
  },
  "perplexity": {
    "avg": 45.93600599145889,
    "median": 35.464256286621094
  },
  "language_distribution": {
    "EN": 1500
  },
  "analysis_time_sec": 215.45
}
2025-11-26 13:28:24 [INFO] Quality report:
2025-11-26 13:28:24 [INFO] {
  "samples_analyzed": 1500,
  "pii_hits": {
    "phone": 69,
    "email": 24,
    "credit_card": 9
  },
  "toxicity": {
    "avg": 0.00878127571195364,
    "max": 0.9331499934196472
  },
  "perplexity": {
    "avg": 45.93600599145889,
    "median": 35.464256286621094
  },
  "language_distribution": {
    "EN": 1500
  },
  "analysis_time_sec": 215.45
}
2025-11-26 13:28:24 [INFO] Computing token length statsâ€¦
2025-11-26 13:28:35 [INFO] Saved token-length statistics to reports/token_length_stats.json
2025-11-26 13:28:35 [INFO] Tokenization...
2025-11-26 13:28:47 [INFO] Tokenized data saved to data/final/tokenized.jsonl
2025-11-26 13:28:47 [INFO] Packing to 2048-token blocks...
2025-11-26 13:28:51 [INFO] Packed blocks saved to data/final/packed_blocks.jsonl
2025-11-26 13:28:51 [INFO] Diagnosing packed block lengths...
2025-11-26 13:28:54 [INFO] Train/Val/Test sharding...
2025-11-26 13:28:54 [INFO] Sharded dataset saved to data/final/sharded_dataset
2025-11-26 13:28:54 [INFO] Writing meta.json...
2025-11-26 13:28:54 [INFO] =*= Pipeline completed successfully =*=
2025-11-26 13:28:54 [INFO] Total pipeline time: 0:10:33
